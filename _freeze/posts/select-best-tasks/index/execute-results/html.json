{
  "hash": "9124022ba77ebb58201540eea66e9785",
  "result": {
    "markdown": "---\ntitle: Notes on Select Best Tasks for Cognitive Sub-Domain\nauthor: Zhang, Liang\ndate: 2023-11-01\ndate-modified: last-modified\nformat:\n  html:\n    code-fold: true\n    toc: true\nexecute:\n  warning: false\ncrossref:\n  fig-title: 图\n  fig-prefix: 图\n  tbl-title: 表\n  tbl-prefix: 表\nbibliography: references.bib\n---\n\n::: {.cell}\n\n```{.r .cell-code}\ndevtools::load_all()\n# the identifiers are large integers\nrequireNamespace(\"bit64\")\nrequireNamespace(\"parameters\")\n\nprojects <- targets::tar_config_yaml()\n```\n:::\n\n\n# 最佳因子模型\n\n我们采用了基于自助法（bootstrap）的因子聚类方法探索任务的因子归类。不过在开始之前，一些特别类似范式的任务仅保留了一个，如 @tbl-schema-thin，其中`thin`一列为`TRUE`的是被去掉的任务。以下用`all`表示使用全部任务，用`thin`表示去掉类似范式任务的结果。\n\n\n::: {#tbl-schema-thin .cell tbl-cap='相似任务保留情况'}\n\n```{.r .cell-code}\nread_tsv(\"config/games_thin.tsv\", show_col_types = FALSE) |>\n  filter(!is.na(same_id)) |>\n  mutate(thin = if_else(thin, \"是\", \"否\")) |>\n  select(same_id, 名称 = game_name, 是否去掉 = thin) |>\n  arrange(same_id, 是否去掉) |>\n  gt::gt(\n    groupname_col = \"same_id\",\n    row_group_as_column = TRUE\n  ) |>\n  gtExtras::gt_highlight_rows(\n    rows = 是否去掉 == \"是\",\n    fill = \"gray\"\n  )\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"wszzcorehh\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#wszzcorehh table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#wszzcorehh thead, #wszzcorehh tbody, #wszzcorehh tfoot, #wszzcorehh tr, #wszzcorehh td, #wszzcorehh th {\n  border-style: none;\n}\n\n#wszzcorehh p {\n  margin: 0;\n  padding: 0;\n}\n\n#wszzcorehh .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#wszzcorehh .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#wszzcorehh .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#wszzcorehh .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#wszzcorehh .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#wszzcorehh .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wszzcorehh .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#wszzcorehh .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#wszzcorehh .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#wszzcorehh .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#wszzcorehh .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#wszzcorehh .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#wszzcorehh .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#wszzcorehh .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#wszzcorehh .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#wszzcorehh .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#wszzcorehh .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#wszzcorehh .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#wszzcorehh .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wszzcorehh .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#wszzcorehh .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#wszzcorehh .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#wszzcorehh .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wszzcorehh .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#wszzcorehh .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#wszzcorehh .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wszzcorehh .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wszzcorehh .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#wszzcorehh .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wszzcorehh .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#wszzcorehh .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wszzcorehh .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#wszzcorehh .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wszzcorehh .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#wszzcorehh .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wszzcorehh .gt_left {\n  text-align: left;\n}\n\n#wszzcorehh .gt_center {\n  text-align: center;\n}\n\n#wszzcorehh .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#wszzcorehh .gt_font_normal {\n  font-weight: normal;\n}\n\n#wszzcorehh .gt_font_bold {\n  font-weight: bold;\n}\n\n#wszzcorehh .gt_font_italic {\n  font-style: italic;\n}\n\n#wszzcorehh .gt_super {\n  font-size: 65%;\n}\n\n#wszzcorehh .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#wszzcorehh .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#wszzcorehh .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#wszzcorehh .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#wszzcorehh .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#wszzcorehh .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#wszzcorehh .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"\"></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"名称\">名称</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"是否去掉\">是否去掉</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr class=\"gt_row_group_first\"><td headers=\"1 stub_1_1 stub_1\" rowspan=\"5\" class=\"gt_row gt_left gt_stub_row_group\">1</td>\n<td headers=\"1 stub_1_1 名称\" class=\"gt_row gt_left\">格子卡片</td>\n<td headers=\"1 stub_1_1 是否去掉\" class=\"gt_row gt_left\">否</td></tr>\n    <tr><td headers=\"1 名称_2 名称\" class=\"gt_row gt_left\" style=\"background-color: rgba(190,190,190,0.8); color: #000000; font-weight: bold;\">美术卡片</td>\n<td headers=\"1 名称_2 是否去掉\" class=\"gt_row gt_left\" style=\"background-color: rgba(190,190,190,0.8); color: #000000; font-weight: bold;\">是</td></tr>\n    <tr><td headers=\"1 名称_3 名称\" class=\"gt_row gt_left\" style=\"background-color: rgba(190,190,190,0.8); color: #000000; font-weight: bold;\">魔术师终极</td>\n<td headers=\"1 名称_3 是否去掉\" class=\"gt_row gt_left\" style=\"background-color: rgba(190,190,190,0.8); color: #000000; font-weight: bold;\">是</td></tr>\n    <tr><td headers=\"1 名称_4 名称\" class=\"gt_row gt_left\" style=\"background-color: rgba(190,190,190,0.8); color: #000000; font-weight: bold;\">数字卡片PRO</td>\n<td headers=\"1 名称_4 是否去掉\" class=\"gt_row gt_left\" style=\"background-color: rgba(190,190,190,0.8); color: #000000; font-weight: bold;\">是</td></tr>\n    <tr><td headers=\"1 名称_5 名称\" class=\"gt_row gt_left\" style=\"background-color: rgba(190,190,190,0.8); color: #000000; font-weight: bold;\">文字卡片</td>\n<td headers=\"1 名称_5 是否去掉\" class=\"gt_row gt_left\" style=\"background-color: rgba(190,190,190,0.8); color: #000000; font-weight: bold;\">是</td></tr>\n    <tr class=\"gt_row_group_first\"><td headers=\"2 stub_1_6 stub_1\" rowspan=\"2\" class=\"gt_row gt_left gt_stub_row_group\">2</td>\n<td headers=\"2 stub_1_6 名称\" class=\"gt_row gt_left\">方向检测</td>\n<td headers=\"2 stub_1_6 是否去掉\" class=\"gt_row gt_left\">否</td></tr>\n    <tr><td headers=\"2 名称_7 名称\" class=\"gt_row gt_left\" style=\"background-color: rgba(190,190,190,0.8); color: #000000; font-weight: bold;\">色彩检测</td>\n<td headers=\"2 名称_7 是否去掉\" class=\"gt_row gt_left\" style=\"background-color: rgba(190,190,190,0.8); color: #000000; font-weight: bold;\">是</td></tr>\n    <tr class=\"gt_row_group_first\"><td headers=\"3 stub_1_8 stub_1\" rowspan=\"3\" class=\"gt_row gt_left gt_stub_row_group\">3</td>\n<td headers=\"3 stub_1_8 名称\" class=\"gt_row gt_left\">注意指向</td>\n<td headers=\"3 stub_1_8 是否去掉\" class=\"gt_row gt_left\">否</td></tr>\n    <tr><td headers=\"3 名称_9 名称\" class=\"gt_row gt_left\" style=\"background-color: rgba(190,190,190,0.8); color: #000000; font-weight: bold;\">太空飞船PRO</td>\n<td headers=\"3 名称_9 是否去掉\" class=\"gt_row gt_left\" style=\"background-color: rgba(190,190,190,0.8); color: #000000; font-weight: bold;\">是</td></tr>\n    <tr><td headers=\"3 名称_10 名称\" class=\"gt_row gt_left\" style=\"background-color: rgba(190,190,190,0.8); color: #000000; font-weight: bold;\">注意警觉</td>\n<td headers=\"3 名称_10 是否去掉\" class=\"gt_row gt_left\" style=\"background-color: rgba(190,190,190,0.8); color: #000000; font-weight: bold;\">是</td></tr>\n    <tr class=\"gt_row_group_first\"><td headers=\"4 stub_1_11 stub_1\" rowspan=\"2\" class=\"gt_row gt_left gt_stub_row_group\">4</td>\n<td headers=\"4 stub_1_11 名称\" class=\"gt_row gt_left\">速算师（中级）</td>\n<td headers=\"4 stub_1_11 是否去掉\" class=\"gt_row gt_left\">否</td></tr>\n    <tr><td headers=\"4 名称_12 名称\" class=\"gt_row gt_left\" style=\"background-color: rgba(190,190,190,0.8); color: #000000; font-weight: bold;\">专注大师_中级</td>\n<td headers=\"4 名称_12 是否去掉\" class=\"gt_row gt_left\" style=\"background-color: rgba(190,190,190,0.8); color: #000000; font-weight: bold;\">是</td></tr>\n    <tr class=\"gt_row_group_first\"><td headers=\"5 stub_1_13 stub_1\" rowspan=\"2\" class=\"gt_row gt_left gt_stub_row_group\">5</td>\n<td headers=\"5 stub_1_13 名称\" class=\"gt_row gt_left\">宇宙黑洞A</td>\n<td headers=\"5 stub_1_13 是否去掉\" class=\"gt_row gt_left\">否</td></tr>\n    <tr><td headers=\"5 名称_14 名称\" class=\"gt_row gt_left\" style=\"background-color: rgba(190,190,190,0.8); color: #000000; font-weight: bold;\">城市导航</td>\n<td headers=\"5 名称_14 是否去掉\" class=\"gt_row gt_left\" style=\"background-color: rgba(190,190,190,0.8); color: #000000; font-weight: bold;\">是</td></tr>\n    <tr class=\"gt_row_group_first\"><td headers=\"6 stub_1_15 stub_1\" rowspan=\"2\" class=\"gt_row gt_left gt_stub_row_group\">6</td>\n<td headers=\"6 stub_1_15 名称\" class=\"gt_row gt_left\">图形折叠</td>\n<td headers=\"6 stub_1_15 是否去掉\" class=\"gt_row gt_left\">否</td></tr>\n    <tr><td headers=\"6 名称_16 名称\" class=\"gt_row gt_left\" style=\"background-color: rgba(190,190,190,0.8); color: #000000; font-weight: bold;\">平面展开</td>\n<td headers=\"6 名称_16 是否去掉\" class=\"gt_row gt_left\" style=\"background-color: rgba(190,190,190,0.8); color: #000000; font-weight: bold;\">是</td></tr>\n    <tr class=\"gt_row_group_first\"><td headers=\"7 stub_1_17 stub_1\" rowspan=\"2\" class=\"gt_row gt_left gt_stub_row_group\">7</td>\n<td headers=\"7 stub_1_17 名称\" class=\"gt_row gt_left\">三维心理旋转测试A</td>\n<td headers=\"7 stub_1_17 是否去掉\" class=\"gt_row gt_left\">否</td></tr>\n    <tr><td headers=\"7 名称_18 名称\" class=\"gt_row gt_left\" style=\"background-color: rgba(190,190,190,0.8); color: #000000; font-weight: bold;\">物体旋转</td>\n<td headers=\"7 名称_18 是否去掉\" class=\"gt_row gt_left\" style=\"background-color: rgba(190,190,190,0.8); color: #000000; font-weight: bold;\">是</td></tr>\n    <tr class=\"gt_row_group_first\"><td headers=\"8 stub_1_19 stub_1\" rowspan=\"3\" class=\"gt_row gt_left gt_stub_row_group\">8</td>\n<td headers=\"8 stub_1_19 名称\" class=\"gt_row gt_left\">语义判断</td>\n<td headers=\"8 stub_1_19 是否去掉\" class=\"gt_row gt_left\">否</td></tr>\n    <tr><td headers=\"8 名称_20 名称\" class=\"gt_row gt_left\" style=\"background-color: rgba(190,190,190,0.8); color: #000000; font-weight: bold;\">词语判断</td>\n<td headers=\"8 名称_20 是否去掉\" class=\"gt_row gt_left\" style=\"background-color: rgba(190,190,190,0.8); color: #000000; font-weight: bold;\">是</td></tr>\n    <tr><td headers=\"8 名称_21 名称\" class=\"gt_row gt_left\" style=\"background-color: rgba(190,190,190,0.8); color: #000000; font-weight: bold;\">声调判断</td>\n<td headers=\"8 名称_21 是否去掉\" class=\"gt_row gt_left\" style=\"background-color: rgba(190,190,190,0.8); color: #000000; font-weight: bold;\">是</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n由于因子个数对于我们的研究很重要，我们尝试了很多传统办法，结果很不稳定：\n\n\n::: {#fig-nfactors .cell}\n\n```{.r .cell-code}\ntargets::tar_read(\n  n_factors_test_all,\n  store = projects$explore_factors$store\n) |>\n  plot()\n\ntargets::tar_read(\n  n_factors_test_thin,\n  store = projects$explore_factors$store\n) |>\n  plot()\n```\n\n::: {.cell-output-display}\n![包含全部任务](index_files/figure-html/fig-nfactors-1.png){#fig-nfactors-1 width=672}\n:::\n\n::: {.cell-output-display}\n![去除同范式任务](index_files/figure-html/fig-nfactors-2.png){#fig-nfactors-2 width=672}\n:::\n\n传统方法的因子个数结果\n:::\n\n\n采用基于自助法的因子聚类方法，结果如 @fig-compare-cluster-factors。\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntargets::tar_read(cluster_stats, store = projects$explore_factors$store) |>\n  ggplot(aes(n_fact, k, fill = crit)) +\n  geom_raster() +\n  geom_point(aes(n_fact, nc), color = \"white\") +\n  facet_wrap(~schema) +\n  scale_x_continuous(name = \"Number of Factors\", expand = c(0, 0)) +\n  scale_y_continuous(name = \"Number of Clusters\", expand = c(0, 0)) +\n  scale_fill_viridis_c(\n    name = \"Silhouette Score\",\n    breaks = scales::breaks_pretty(n = 4)\n  ) +\n  theme_minimal(base_size = 16) +\n  theme(legend.position = \"top\") +\n  coord_fixed()\n```\n\n::: {.cell-output-display}\n![Evaluation of clustering results](index_files/figure-html/fig-compare-cluster-factors-1.png){#fig-compare-cluster-factors width=960}\n:::\n:::\n\n\n我们将每种因子个数条件的最佳聚类结果进一步用验证性因子分析确定哪个模型最佳。注意，我们可以得到每个任务指标的轮廓系数（silhouette score），并且可以用此系数来确定该任务归入对应类别的可信度。一般而言，轮廓系数大于0.5[^1]时才可靠。同时，为了保证因子分析结果的可比性，我们将轮廓系数不达标的的任务指标的载荷固定为0后做验证性因素分析。注意这样也会导致一些聚类结果中部分因子的所有成分指标载荷为0，从而导致模型不能成功拟合，也说明这种聚类结果的不可靠。\n\n[^1]: 查看[ResearchGate上的一个讨论](https://www.researchgate.net/post/Threshold_silhouette_score_for_cluster_analysis)确定这标准来源。\n\n\n::: {#fig-fitmeas-models .cell}\n\n```{.r .cell-code}\ntar_load(\n  c(gofs, cluster_stats), \n  store = projects$explore_factors$store\n)\nstats <- cluster_stats |> \n  filter(k == nc) |> \n  full_join(gofs, by = c(\"schema\", \"n_fact\"))\n\nmeasures <- c(\"crit\", \"bic\", \"cfi\", \"rmsea\")\nfor (measure in measures) {\n  p <- stats |> \n    filter(!is.na(.data[[measure]])) |> \n    ggplot(aes(n_fact, .data[[measure]])) +\n    geom_point() +\n    geom_line() +\n    scale_x_continuous(\n      name = \"Number of Factors\", \n      breaks = scales::breaks_width(1)\n    ) +\n    facet_wrap(~ schema, scales = \"free_y\") +\n    ggpubr::theme_pubclean()\n  print(p)\n}\n```\n\n::: {.cell-output-display}\n![Mean Silhouette Score](index_files/figure-html/fig-fitmeas-models-1.png){#fig-fitmeas-models-1 width=672}\n:::\n\n::: {.cell-output-display}\n![BIC](index_files/figure-html/fig-fitmeas-models-2.png){#fig-fitmeas-models-2 width=672}\n:::\n\n::: {.cell-output-display}\n![CFI](index_files/figure-html/fig-fitmeas-models-3.png){#fig-fitmeas-models-3 width=672}\n:::\n\n::: {.cell-output-display}\n![RMSEA](index_files/figure-html/fig-fitmeas-models-4.png){#fig-fitmeas-models-4 width=672}\n:::\n\n所有聚类模型拟合情况（仅展示成功拟合的模型）\n:::\n\n\n进一步，根据Vuong [-@vuong1989]提出的比较非嵌套模型的检验，我们也对拟合成功的模型做了两两比较。\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntargets::tar_read(comparison, store = projects$explore_factors$store) |> \n  select(left, right, everything()) |> \n  arrange(right) |> \n  gt::gt(groupname_col = \"schema\", row_group_as_column = TRUE) |> \n  gt::fmt_number(columns = !c(left, right))\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"sanklqbzgu\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#sanklqbzgu table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#sanklqbzgu thead, #sanklqbzgu tbody, #sanklqbzgu tfoot, #sanklqbzgu tr, #sanklqbzgu td, #sanklqbzgu th {\n  border-style: none;\n}\n\n#sanklqbzgu p {\n  margin: 0;\n  padding: 0;\n}\n\n#sanklqbzgu .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#sanklqbzgu .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#sanklqbzgu .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#sanklqbzgu .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#sanklqbzgu .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#sanklqbzgu .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#sanklqbzgu .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#sanklqbzgu .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#sanklqbzgu .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#sanklqbzgu .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#sanklqbzgu .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#sanklqbzgu .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#sanklqbzgu .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#sanklqbzgu .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#sanklqbzgu .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#sanklqbzgu .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#sanklqbzgu .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#sanklqbzgu .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#sanklqbzgu .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#sanklqbzgu .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#sanklqbzgu .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#sanklqbzgu .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#sanklqbzgu .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#sanklqbzgu .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#sanklqbzgu .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#sanklqbzgu .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#sanklqbzgu .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#sanklqbzgu .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#sanklqbzgu .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#sanklqbzgu .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#sanklqbzgu .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#sanklqbzgu .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#sanklqbzgu .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#sanklqbzgu .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#sanklqbzgu .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#sanklqbzgu .gt_left {\n  text-align: left;\n}\n\n#sanklqbzgu .gt_center {\n  text-align: center;\n}\n\n#sanklqbzgu .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#sanklqbzgu .gt_font_normal {\n  font-weight: normal;\n}\n\n#sanklqbzgu .gt_font_bold {\n  font-weight: bold;\n}\n\n#sanklqbzgu .gt_font_italic {\n  font-style: italic;\n}\n\n#sanklqbzgu .gt_super {\n  font-size: 65%;\n}\n\n#sanklqbzgu .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#sanklqbzgu .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#sanklqbzgu .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#sanklqbzgu .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#sanklqbzgu .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#sanklqbzgu .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#sanklqbzgu .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"\"></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"left\">left</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"right\">right</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"omega\">omega</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p_omega\">p_omega</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p_left_better\">p_left_better</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p_right_better\">p_right_better</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr class=\"gt_row_group_first\"><td headers=\"all stub_1_1 stub_1\" rowspan=\"3\" class=\"gt_row gt_left gt_stub_row_group\">all</td>\n<td headers=\"all stub_1_1 left\" class=\"gt_row gt_right\">5</td>\n<td headers=\"all stub_1_1 right\" class=\"gt_row gt_right\">4</td>\n<td headers=\"all stub_1_1 omega\" class=\"gt_row gt_right\">5.62</td>\n<td headers=\"all stub_1_1 p_omega\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"all stub_1_1 p_left_better\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"all stub_1_1 p_right_better\" class=\"gt_row gt_right\">0.00</td></tr>\n    <tr><td headers=\"all left_2 left\" class=\"gt_row gt_right\">6</td>\n<td headers=\"all left_2 right\" class=\"gt_row gt_right\">4</td>\n<td headers=\"all left_2 omega\" class=\"gt_row gt_right\">9.88</td>\n<td headers=\"all left_2 p_omega\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"all left_2 p_left_better\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"all left_2 p_right_better\" class=\"gt_row gt_right\">0.00</td></tr>\n    <tr><td headers=\"all left_3 left\" class=\"gt_row gt_right\">6</td>\n<td headers=\"all left_3 right\" class=\"gt_row gt_right\">5</td>\n<td headers=\"all left_3 omega\" class=\"gt_row gt_right\">3.75</td>\n<td headers=\"all left_3 p_omega\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"all left_3 p_left_better\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"all left_3 p_right_better\" class=\"gt_row gt_right\">0.00</td></tr>\n    <tr class=\"gt_row_group_first\"><td headers=\"thin stub_1_4 stub_1\" rowspan=\"10\" class=\"gt_row gt_left gt_stub_row_group\">thin</td>\n<td headers=\"thin stub_1_4 left\" class=\"gt_row gt_right\">6</td>\n<td headers=\"thin stub_1_4 right\" class=\"gt_row gt_right\">5</td>\n<td headers=\"thin stub_1_4 omega\" class=\"gt_row gt_right\">1.37</td>\n<td headers=\"thin stub_1_4 p_omega\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"thin stub_1_4 p_left_better\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"thin stub_1_4 p_right_better\" class=\"gt_row gt_right\">1.00</td></tr>\n    <tr><td headers=\"thin left_5 left\" class=\"gt_row gt_right\">7</td>\n<td headers=\"thin left_5 right\" class=\"gt_row gt_right\">5</td>\n<td headers=\"thin left_5 omega\" class=\"gt_row gt_right\">3.85</td>\n<td headers=\"thin left_5 p_omega\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"thin left_5 p_left_better\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"thin left_5 p_right_better\" class=\"gt_row gt_right\">1.00</td></tr>\n    <tr><td headers=\"thin left_6 left\" class=\"gt_row gt_right\">8</td>\n<td headers=\"thin left_6 right\" class=\"gt_row gt_right\">5</td>\n<td headers=\"thin left_6 omega\" class=\"gt_row gt_right\">4.32</td>\n<td headers=\"thin left_6 p_omega\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"thin left_6 p_left_better\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"thin left_6 p_right_better\" class=\"gt_row gt_right\">1.00</td></tr>\n    <tr><td headers=\"thin left_7 left\" class=\"gt_row gt_right\">9</td>\n<td headers=\"thin left_7 right\" class=\"gt_row gt_right\">5</td>\n<td headers=\"thin left_7 omega\" class=\"gt_row gt_right\">4.32</td>\n<td headers=\"thin left_7 p_omega\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"thin left_7 p_left_better\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"thin left_7 p_right_better\" class=\"gt_row gt_right\">1.00</td></tr>\n    <tr><td headers=\"thin left_8 left\" class=\"gt_row gt_right\">7</td>\n<td headers=\"thin left_8 right\" class=\"gt_row gt_right\">6</td>\n<td headers=\"thin left_8 omega\" class=\"gt_row gt_right\">2.29</td>\n<td headers=\"thin left_8 p_omega\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"thin left_8 p_left_better\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"thin left_8 p_right_better\" class=\"gt_row gt_right\">1.00</td></tr>\n    <tr><td headers=\"thin left_9 left\" class=\"gt_row gt_right\">8</td>\n<td headers=\"thin left_9 right\" class=\"gt_row gt_right\">6</td>\n<td headers=\"thin left_9 omega\" class=\"gt_row gt_right\">2.71</td>\n<td headers=\"thin left_9 p_omega\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"thin left_9 p_left_better\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"thin left_9 p_right_better\" class=\"gt_row gt_right\">1.00</td></tr>\n    <tr><td headers=\"thin left_10 left\" class=\"gt_row gt_right\">9</td>\n<td headers=\"thin left_10 right\" class=\"gt_row gt_right\">6</td>\n<td headers=\"thin left_10 omega\" class=\"gt_row gt_right\">2.90</td>\n<td headers=\"thin left_10 p_omega\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"thin left_10 p_left_better\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"thin left_10 p_right_better\" class=\"gt_row gt_right\">1.00</td></tr>\n    <tr><td headers=\"thin left_11 left\" class=\"gt_row gt_right\">8</td>\n<td headers=\"thin left_11 right\" class=\"gt_row gt_right\">7</td>\n<td headers=\"thin left_11 omega\" class=\"gt_row gt_right\">1.28</td>\n<td headers=\"thin left_11 p_omega\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"thin left_11 p_left_better\" class=\"gt_row gt_right\">0.99</td>\n<td headers=\"thin left_11 p_right_better\" class=\"gt_row gt_right\">0.01</td></tr>\n    <tr><td headers=\"thin left_12 left\" class=\"gt_row gt_right\">9</td>\n<td headers=\"thin left_12 right\" class=\"gt_row gt_right\">7</td>\n<td headers=\"thin left_12 omega\" class=\"gt_row gt_right\">1.70</td>\n<td headers=\"thin left_12 p_omega\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"thin left_12 p_left_better\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"thin left_12 p_right_better\" class=\"gt_row gt_right\">0.00</td></tr>\n    <tr><td headers=\"thin left_13 left\" class=\"gt_row gt_right\">9</td>\n<td headers=\"thin left_13 right\" class=\"gt_row gt_right\">8</td>\n<td headers=\"thin left_13 omega\" class=\"gt_row gt_right\">0.54</td>\n<td headers=\"thin left_13 p_omega\" class=\"gt_row gt_right\">0.00</td>\n<td headers=\"thin left_13 p_left_better\" class=\"gt_row gt_right\">1.00</td>\n<td headers=\"thin left_13 p_right_better\" class=\"gt_row gt_right\">0.00</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n因此，最终采用`thin`里面最佳聚类结果的模型，其具体结果如 @fig-best-model 。基于此结果我们可以比较确定地指出我们的数据可以很好地拟合一个包含七个因子的模型，根据每一个因子里面包含任务之间的关系，我们给出这些因子的名字见。\n\n\n::: {.cell .column-page}\n\n```{.r .cell-code}\ntargets::tar_read(config_thin_1, store = projects$explore_factors$store) |>\n  separate_wider_delim(\n    game_index, \".\",\n    names = c(\"game_name_abbr\", \"index_name\")\n  ) |>\n  mutate(\n    game_name = pull(\n      data.iquizoo::game_info,\n      game_name,\n      game_name_abbr\n    )[game_name_abbr]\n  ) |>\n  ggplot(aes(label = game_name, size = sil_width, color = sil_width < 0.5)) +\n  ggwordcloud::geom_text_wordcloud() +\n  scale_color_grey() +\n  facet_wrap(~latent) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![最佳模型各因子所含任务指标](index_files/figure-html/fig-best-model-1.png){#fig-best-model width=960}\n:::\n:::\n\n::: {#tbl-dimensions .cell tbl-cap='各维度命名'}\n\n```{.r .cell-code}\ndimensions <- read_csv(\"config/dimensions.csv\", show_col_types = FALSE) \ndimensions |> \n  mutate(factor = str_c(\"F\", cluster), .keep = \"unused\", .before = 1L) |> \n  gt::gt(rowname_col = \"factor\")\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"rrrzhmiwcs\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#rrrzhmiwcs table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#rrrzhmiwcs thead, #rrrzhmiwcs tbody, #rrrzhmiwcs tfoot, #rrrzhmiwcs tr, #rrrzhmiwcs td, #rrrzhmiwcs th {\n  border-style: none;\n}\n\n#rrrzhmiwcs p {\n  margin: 0;\n  padding: 0;\n}\n\n#rrrzhmiwcs .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#rrrzhmiwcs .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#rrrzhmiwcs .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#rrrzhmiwcs .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#rrrzhmiwcs .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#rrrzhmiwcs .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rrrzhmiwcs .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#rrrzhmiwcs .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#rrrzhmiwcs .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#rrrzhmiwcs .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#rrrzhmiwcs .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#rrrzhmiwcs .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#rrrzhmiwcs .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#rrrzhmiwcs .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#rrrzhmiwcs .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#rrrzhmiwcs .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#rrrzhmiwcs .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#rrrzhmiwcs .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#rrrzhmiwcs .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rrrzhmiwcs .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#rrrzhmiwcs .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#rrrzhmiwcs .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#rrrzhmiwcs .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rrrzhmiwcs .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#rrrzhmiwcs .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#rrrzhmiwcs .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rrrzhmiwcs .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rrrzhmiwcs .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#rrrzhmiwcs .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rrrzhmiwcs .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#rrrzhmiwcs .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rrrzhmiwcs .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#rrrzhmiwcs .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rrrzhmiwcs .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#rrrzhmiwcs .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rrrzhmiwcs .gt_left {\n  text-align: left;\n}\n\n#rrrzhmiwcs .gt_center {\n  text-align: center;\n}\n\n#rrrzhmiwcs .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#rrrzhmiwcs .gt_font_normal {\n  font-weight: normal;\n}\n\n#rrrzhmiwcs .gt_font_bold {\n  font-weight: bold;\n}\n\n#rrrzhmiwcs .gt_font_italic {\n  font-style: italic;\n}\n\n#rrrzhmiwcs .gt_super {\n  font-size: 65%;\n}\n\n#rrrzhmiwcs .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#rrrzhmiwcs .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#rrrzhmiwcs .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#rrrzhmiwcs .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#rrrzhmiwcs .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#rrrzhmiwcs .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#rrrzhmiwcs .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"\"></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"dim_name\">dim_name</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"dim_label\">dim_label</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><th id=\"stub_1_1\" scope=\"row\" class=\"gt_row gt_left gt_stub\">F1</th>\n<td headers=\"stub_1_1 dim_name\" class=\"gt_row gt_left\">WM-Reasoning</td>\n<td headers=\"stub_1_1 dim_label\" class=\"gt_row gt_left\">WM_Rsn</td></tr>\n    <tr><th id=\"stub_1_2\" scope=\"row\" class=\"gt_row gt_left gt_stub\">F2</th>\n<td headers=\"stub_1_2 dim_name\" class=\"gt_row gt_left\">Inhibition</td>\n<td headers=\"stub_1_2 dim_label\" class=\"gt_row gt_left\">Inh</td></tr>\n    <tr><th id=\"stub_1_3\" scope=\"row\" class=\"gt_row gt_left gt_stub\">F3</th>\n<td headers=\"stub_1_3 dim_name\" class=\"gt_row gt_left\">Verbal STM</td>\n<td headers=\"stub_1_3 dim_label\" class=\"gt_row gt_left\">VSTM</td></tr>\n    <tr><th id=\"stub_1_4\" scope=\"row\" class=\"gt_row gt_left gt_stub\">F4</th>\n<td headers=\"stub_1_4 dim_name\" class=\"gt_row gt_left\">Spatial STM</td>\n<td headers=\"stub_1_4 dim_label\" class=\"gt_row gt_left\">SSTM</td></tr>\n    <tr><th id=\"stub_1_5\" scope=\"row\" class=\"gt_row gt_left gt_stub\">F5</th>\n<td headers=\"stub_1_5 dim_name\" class=\"gt_row gt_left\">Attention and Speed</td>\n<td headers=\"stub_1_5 dim_label\" class=\"gt_row gt_left\">Att_Spd</td></tr>\n    <tr><th id=\"stub_1_6\" scope=\"row\" class=\"gt_row gt_left gt_stub\">F6</th>\n<td headers=\"stub_1_6 dim_name\" class=\"gt_row gt_left\">Episodic Memory</td>\n<td headers=\"stub_1_6 dim_label\" class=\"gt_row gt_left\">EM</td></tr>\n    <tr><th id=\"stub_1_7\" scope=\"row\" class=\"gt_row gt_left gt_stub\">F7</th>\n<td headers=\"stub_1_7 dim_name\" class=\"gt_row gt_left\">Shifting</td>\n<td headers=\"stub_1_7 dim_label\" class=\"gt_row gt_left\">Shift</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n# 拟合优化\n\n对于以上的因子聚类结果，采用以下几个方案以寻找优化拟合指标方案：\n\n* `full`：每个因子内部所有成员\n* `good_sil`：仅包含轮廓系数大于0.5的成员\n* `top_sil_3`：仅包含轮廓系数最大三个成员\n* `top_sil_4`：仅包含轮廓系数最大四个成员\n* `good_load`：仅包含因子载荷大于0.4的成员（载荷基于`good_sil`，下同）\n* `top_load_3`：仅包含因子载荷最大三个成员\n* `top_load_4`：仅包含因子载荷最大四个成员\n\n@fig-parsi-models 给出了各种方案不同模型的拟合优度。整体上看，基于载荷或者轮廓系数选出的任务都能得到相对较好的CFI拟合指标（>0.9），我们进一步看看各种方案得到的各个潜变量得分的相关高低。\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntar_read(gofs, store = projects$confirm_factors$store) |> \n  mutate(name = factor(name, hypers_config_dims$name)) |> \n  ggplot(aes(name, cfi, color = theory)) +\n  geom_point() +\n  geom_line(aes(group = theory)) +\n  ggpubr::theme_pubclean() +\n  scale_x_discrete(name = NULL)\n```\n\n::: {.cell-output-display}\n![不同方案CFI拟合优度](index_files/figure-html/fig-parsi-models-1.png){#fig-parsi-models width=672}\n:::\n:::\n\n::: {#fig-cor-fact-scores .cell}\n\n```{.r .cell-code}\ntar_load(scores_factor, store = projects$confirm_factors$store)\nfactors <- c(\"g\", dimensions$dim_label)\nfor (factor in factors) {\n  p <- scores_factor |> \n    filter(theory == \"bf\") |> \n    pivot_wider(\n      id_cols = user_id,\n      names_from = name,\n      values_from = all_of(factor)\n    ) |> \n    select(-user_id) |> \n    GGally::ggpairs() +\n    ggtitle(factor)\n  print(p)\n}\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/fig-cor-fact-scores-1.png){#fig-cor-fact-scores-1 width=1152}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/fig-cor-fact-scores-2.png){#fig-cor-fact-scores-2 width=1152}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/fig-cor-fact-scores-3.png){#fig-cor-fact-scores-3 width=1152}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/fig-cor-fact-scores-4.png){#fig-cor-fact-scores-4 width=1152}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/fig-cor-fact-scores-5.png){#fig-cor-fact-scores-5 width=1152}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/fig-cor-fact-scores-6.png){#fig-cor-fact-scores-6 width=1152}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/fig-cor-fact-scores-7.png){#fig-cor-fact-scores-7 width=1152}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/fig-cor-fact-scores-8.png){#fig-cor-fact-scores-8 width=1152}\n:::\n\n各种方案的因子得分相关\n:::\n\n\n因此，我们确定了所有测评的维度，以及每个维度最佳的3-4个测评任务。同时，由于部分任务的轮廓系数值太低，我们将它们从模型中移除。这里假定这些任务背后有主要的几个认知维度起作用，而一些别的任务要么是类似任务太少从而不能较准确形成分组因子，要么是很复杂的任务，至少两个我们找到的因子对其有贡献。进一步地，我们还去掉了因子载荷低于0.4的任务，并基于此计算各个因子的得分。\n\n# 短版本\n\n\n以下是一些基本的前提要求：\n\n-   每个维度选择3个任务\n-   保证选择出来的任务不能太类似\n-   保证拟合优度达标\n-   排除n-back任务\n-   排除专注大师_中级（和速算师太类似）\n-   排除词汇判断、声调判断（和语义判断太类似）\n-   排除数感、捉虫高级版（目前被归入抑制类任务，不太典型）\n-   排除连点成画、变戏法（目前被归入分配注意类任务，不太典型）\n\n基于以上规则然后选择每个维度载荷最高的任务（基于2nd order model）：\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntargets::tar_load(\n  c(dims_origin, indices_wider_clean,\n    fit_origin_bifactor, fit_origin_highorder,\n    scores_origin),\n  store = projects$confirm_factors$store\n)\ntargets::tar_load(\n  c(indices, durations),\n  store = projects$prepare_source_data$store\n)\ntargets::tar_load(\n  reliability,\n  store = projects$prepare_source_data_retest$store\n)\nexclude <- c(\n  \"CalcSpdMed.nc\", \"Lexic.nc\", \"Tone.nc\",\n  \"NsymNCmp.w\", \"TOVAS.dprime\",\n  \"AntiSac.ies\", \"FPTPro.nc\"\n)\ntask_loadings <- list(\n  highorder = fit_origin_highorder,\n  bifactor = fit_origin_bifactor\n) |>\n  map(\n    ~ parameters::model_parameters(.x, standardize = TRUE) |>\n      filter(Component == \"Loading\") |>\n      as_tibble()\n  ) |>\n  bind_rows(.id = \"model\")\ngame_ver_latest <- indices |>\n  summarise(\n    ver_major_latest = max(str_extract(game_version, \"\\\\d\")),\n    .by = game_id\n  )\n\ndim_task_sel <- task_loadings |>\n  filter(\n    To != \"g\",\n    !From %in% exclude,\n    model == \"highorder\"\n  ) |>\n  slice_max(Coefficient, n = 3, by = To)\ndim_task_sel |>\n  separate_wider_delim(\n    From, \".\",\n    names = c(\"game_name_abbr\", \"index_name\")\n  ) |>\n  left_join(data.iquizoo::game_info, by = \"game_name_abbr\") |>\n  left_join(game_ver_latest, by = \"game_id\") |>\n  left_join(durations, by = \"game_id\") |>\n  left_join(\n    reliability |>\n      filter(\n        origin == \"rm_out\",\n        ver_major == max(ver_major),\n        .by = game_id\n      ),\n    by = join_by(game_id, index_name)\n  ) |>\n  select(\n    game_id, game_name, dim_label = To, load = Coefficient,\n    dur_min = numeric.p75, N = n, r, icc,\n    ver_major_latest, ver_major\n  ) |>\n  gt::gt() |>\n  gt::fmt_number(-N) |>\n  gt::cols_hide(contains(\"ver_major\")) |>\n  gt::tab_footnote(\n    \"Reliability measure is based on an older version.\",\n    gt::cells_body(\n      columns = game_name,\n      rows = ver_major_latest > ver_major\n    )\n  ) |>\n  gt::tab_footnote(\n    paste(\n      \"Based on 75% quantile,\",\n      \"i.e., 75% people will finish the task within given time (unit: minutes).\"\n    ),\n    gt::cells_column_labels(dur_min)\n  ) |>\n  gt::opt_footnote_marks(\"standard\")\n```\n:::\n\n\n这些任务的拟合情况总结（整体上模型拟合优度良好）：\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit <- dim_task_sel |>\n  prepare_model(\n    col_dim = \"To\",\n    col_task = \"From\",\n    hierarchical = \"bifactor\"\n  ) |>\n  fit_cfa(indices_wider_clean, orthogonal = TRUE)\nsummary(fit, fit.measures = TRUE, standardized = TRUE)\n```\n:::\n\n\n<!-- TODO: 加入简短版本拟合情况 -->\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncor_task_dim <- indices_wider_clean |>\n  pivot_longer(\n    -user_id,\n    names_to = \"game_index\",\n    values_to = \"score_game\"\n  ) |>\n  inner_join(dims_origin, by = \"game_index\") |>\n  inner_join(\n    scores_origin |>\n      pivot_longer(\n        -c(hierarchical, user_id),\n        names_to = \"dim_label\",\n        values_to = \"score_latent\"\n      ),\n    by = c(\"user_id\", \"dim_label\"),\n    relationship = \"many-to-many\"\n  ) |>\n  summarise(\n    r = cor(score_game, score_latent, use = \"pairwise\"),\n    .by = c(hierarchical, game_index, dim_label)\n  )\nselection_1 <- cor_task_dim |>\n  filter(!game_index %in% exclude, hierarchical == \"highorder\") |>\n  slice_max(r, n = 3, by = dim_label)\nfit_1 <- selection_1 |>\n  prepare_model(\n    col_dim = \"dim_label\",\n    col_task = \"game_index\",\n    hierarchical = \"bifactor\"\n  ) |>\n  fit_cfa(indices_wider_clean, orthogonal = TRUE)\nsummary(fit_1, fit.measures = TRUE, standardized = TRUE)\n```\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}